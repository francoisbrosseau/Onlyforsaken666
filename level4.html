<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Level 4 — The Hall of Whispering Stone</title>

  <!-- IMPORTANT:
    Put the SAME stylesheet link you use on Level 2/3 right here.
    If Level 2/3 don't use a stylesheet link, remove this line.
    If they do, keep the exact same filename/path.
  -->
  <link rel="stylesheet" href="style.css" />

  <style>
    :root{
      /* Color tuning to match “dark parchment / grim” instead of pure white */
      --ink: rgba(238, 231, 221, .93);
      --muted: rgba(238, 231, 221, .72);
      --faint: rgba(238, 231, 221, .52);

      --panelTop: rgba(0,0,0,.60);
      --panelBot: rgba(0,0,0,.40);

      --edge: rgba(255,255,255,.10);
      --edge2: rgba(255,255,255,.18);

      --cold: rgba(155, 210, 255, .30);
      --blood: rgba(160, 25, 35, .22);

      --warn: rgba(255,140,140,.88);
      --ok: rgba(170,255,210,.92);
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }

    /* DO NOT SET ANY FONT HERE. Inherit exactly from your Level 2/3 setup. */
    body{
      margin:0;
      color: var(--ink);
      background:#000;
      overflow-x:hidden;
    }

    /* Background image layer */
    .bg{
      position:fixed;
      inset:0;
      z-index:-3;
      background:#000;
      overflow:hidden;
    }
    .bg img{
      width:100%;
      height:100%;
      object-fit:cover;
      transform: scale(1.03);
      filter: contrast(1.03) brightness(.74) saturate(.95);
    }

    /* Overlay / vignette to match your earlier levels */
    .overlay{
      position:fixed;
      inset:0;
      z-index:-2;
      background:
        radial-gradient(900px 560px at 50% 35%, rgba(0,0,0,.18), rgba(0,0,0,.74) 70%, rgba(0,0,0,.90) 100%),
        linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.78));
    }

    /* subtle “bloody” tint */
    .tint{
      position:fixed;
      inset:0;
      z-index:-1;
      pointer-events:none;
      background:
        radial-gradient(650px 420px at 30% 65%, var(--blood), transparent 70%),
        radial-gradient(650px 420px at 70% 45%, rgba(155,210,255,.10), transparent 70%);
      mix-blend-mode: screen;
      opacity:.35;
      filter: blur(6px);
    }

    /* Centered layout */
    .wrap{
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 56px 16px;
    }

    .panel{
      width: min(860px, 100%);
      background: linear-gradient(180deg, var(--panelTop), var(--panelBot));
      border: 1px solid var(--edge);
      border-radius: 18px;
      box-shadow: 0 24px 70px rgba(0,0,0,.74);
      backdrop-filter: blur(6px);
      overflow:hidden;
    }

    .header{
      padding: 22px 22px 16px;
      border-bottom: 1px solid var(--edge);
      background: linear-gradient(180deg, rgba(255,255,255,.05), transparent);
    }

    .kicker{
      margin:0 0 8px;
      font-size: 12px;
      letter-spacing: .32em;
      text-transform: uppercase;
      color: var(--faint);
    }

    /* DO NOT SET FONT-FAMILY. Title inherits Level 2/3 font. */
    h1{
      margin:0;
      font-size: clamp(34px, 4.6vw, 56px);
      letter-spacing:.03em;
      line-height:1.02;
      text-shadow: 0 0 22px rgba(255,255,255,.10);
    }

    .sub{
      margin: 10px 0 0;
      color: var(--muted);
      font-size: 16px;
      line-height: 1.6;
      max-width: 72ch;
    }

    .body{
      padding: 18px 22px 22px;
    }

    /* Story inherits font from Level 2/3 — we only control sizing/spacing */
    .story{
      font-size: 18px;
      line-height: 1.9;
      letter-spacing: .01em;
      text-shadow: 0 1px 0 rgba(0,0,0,.35);
    }
    .story p{ margin: 0 0 14px; }

    .quote{
      margin: 16px 0 18px;
      padding: 14px 14px;
      border-left: 3px solid var(--cold);
      background: rgba(0,0,0,.26);
      border-radius: 12px;
      color: rgba(238,231,221,.92);
    }

    .sep{
      height:1px;
      background: linear-gradient(90deg, transparent, var(--edge2), transparent);
      margin: 16px 0;
    }

    .riddleTitle{
      margin: 0 0 8px;
      font-size: 24px;
      letter-spacing:.04em;
    }

    .riddle{
      margin:0;
      padding: 14px 14px;
      border-radius: 14px;
      border: 1px solid var(--edge);
      background: rgba(0,0,0,.22);
      font-size: 18px;
      line-height: 1.7;
      color: rgba(238,231,221,.92);
    }

    .gate{
      margin-top: 18px;
      padding: 14px 14px;
      border-radius: 14px;
      border: 1px solid var(--edge);
      background: rgba(0,0,0,.22);
    }

    .gateRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 10px;
    }

    input[type="password"]{
      flex: 1 1 220px;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.38);
      color: var(--ink);
      outline:none;
      font-size: 16px;
    }
    input[type="password"]:focus{
      border-color: rgba(155,210,255,.30);
      box-shadow: 0 0 0 4px rgba(155,210,255,.08);
    }

    .btn{
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: var(--ink);
      cursor:pointer;
      font-size: 16px;
    }
    .btn:hover{ background: rgba(255,255,255,.09); }

    .msg{
      min-height: 22px;
      margin-top: 10px;
      color: var(--muted);
      font-size: 15px;
    }
    .msg.error{ color: var(--warn); }
    .msg.ok{ color: var(--ok); }

    .reveal{
      display:none;
      margin-top: 12px;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(155,210,255,.22);
      background: rgba(0,0,0,.18);
    }
    .reveal a{
      color: rgba(200,235,255,.92);
      text-decoration:none;
      border-bottom: 1px solid rgba(200,235,255,.25);
    }
    .reveal a:hover{ border-bottom-color: rgba(200,235,255,.55); }

    /* Hidden meta: B R E A T H in normal-looking words */
    .sigil{ color: inherit; }
    .hintOn .sigil{
      text-shadow: 0 0 10px rgba(155,210,255,.18);
      border-bottom: 1px dotted rgba(155,210,255,.22);
    }

    .hintBar{
      display:flex;
      justify-content:flex-end;
      margin: 8px 0 0;
    }
    .hintBtn{
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color: var(--muted);
      cursor:pointer;
      font-size: 14px;
    }
    .hintBtn:hover{ background: rgba(255,255,255,.05); }

    /* Image slot + optional picker */
    .bgTools{
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid rgba(255,255,255,.10);
      color: var(--faint);
      font-size: 13px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }

    .footer{
      padding: 14px 22px 16px;
      border-top: 1px solid var(--edge);
      color: var(--faint);
      letter-spacing: .28em;
      text-transform: uppercase;
      font-size: 12px;
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:10px;
      background: rgba(0,0,0,.14);
    }
  </style>
</head>

<body>
  <!-- ✅ Put your generated image here -->
  <!-- Save the corridor image as: level4.jpg (same folder as this HTML) -->
  <div class="bg">
    <img id="bgImage" src="level4.jpg" alt="">
  </div>
  <div class="overlay"></div>
  <div class="tint"></div>

  <main class="wrap">
    <section class="panel" id="panel">
      <header class="header">
        <p class="kicker">Castle Descent • Level 4</p>
        <h1>The Hall of Whispering Stone</h1>
        <p class="sub">
          You descend past the statue. The castle grows quieter… but not emptier.
        </p>
      </header>

      <div class="body">
        <article class="story">
          <p>The stairs spiral down far longer than they should.</p>

          <p>
            Your footsteps echo, but the echo returns a fraction too late—like something is repeating them after you.
            The air tastes of dust and old iron.
          </p>

          <p>
            At the bottom, the stairwell opens into a corridor carved from black rock. No torches. No windows.
            Yet you can see.
          </p>

          <p>
            The walls are covered with shapes that almost look like faces, stretching outward from the stone,
            mouths open in silent warnings. Their eyes follow you as you walk.
          </p>

          <p>
            Halfway down, the whispers begin. Not loud enough to understand—layered, desperate, overlapping.
            Some beg. Some laugh. Some repeat the same word again and again.
          </p>

          <div class="quote">
            At the far end stands a door of pale marble, untouched by age. Letters carve themselves into its surface,
            as if written by an invisible claw. The whispers stop. One voice remains:
            <br><br>
            “If you wish to go further, you must answer.
            Speak the thing that is taken from you the moment you try to hold it.”
          </div>

          <p>
            The corridor feels <span class="sigil">B</span>lessed and cursed at once—like it was built to listen.
            Your chest rises, then stills, as if the stone is counting.
            The marble waits, patient as <span class="sigil">R</span>uins.
          </p>

          <p>
            You try to steady yourself, but the air refuses to belong to you.
            The walls drink warmth with every step, and even the silence feels <span class="sigil">E</span>arned.
          </p>

          <p>
            A thin fog curls along the floor, slipping around your ankles like a warning you can’t <span class="sigil">A</span>void.
            Somewhere behind the stone faces, something sighs.
          </p>

          <p>
            Instinct says to hold on—but the moment you grip it, it leaves you. Always. Without <span class="sigil">T</span>ouch.
          </p>

          <p>
            The last whisper is close enough to feel against your skin—
            a reminder that even courage needs a <span class="sigil">H</span>ollow space to enter.
          </p>

          <div class="hintBar">
            <button class="hintBtn" id="hintBtn">Toggle subtle hint</button>
          </div>

          <div class="sep"></div>

          <h2 class="riddleTitle">Riddle</h2>
          <p class="riddle">“What is taken from you the moment you try to hold it?”</p>

          <div class="gate">
            <div>Enter the password to descend.</div>

            <div class="gateRow">
              <input id="pw" type="password" placeholder="Password…" autocomplete="off" />
              <button class="btn" id="enterBtn">Enter</button>
            </div>

            <div class="msg" id="msg"></div>

            <div class="reveal" id="reveal">
              The marble seam opens with a slow exhale.
              <br><br>
              <a href="level5.html">Continue to Level 5 →</a>
            </div>

            <!-- ✅ Optional: quick file picker to preview the image instantly -->
            <div class="bgTools">
              <span>Background image:</span>
              <input id="bgUpload" type="file" accept="image/jpeg,image/jpg,image/png,image/webp" />
            </div>
          </div>
        </article>
      </div>

      <footer class="footer">
        <span>ONLY FORSAKEN</span>
        <span>LEVEL 4</span>
      </footer>
    </section>
  </main>

  <script>
    const ACCEPTED = new Set(["breathe","breath"]);

    const panel = document.getElementById("panel");
    const hintBtn = document.getElementById("hintBtn");

    const pw = document.getElementById("pw");
    const enterBtn = document.getElementById("enterBtn");
    const msg = document.getElementById("msg");
    const reveal = document.getElementById("reveal");

    const bgUpload = document.getElementById("bgUpload");
    const bgImage = document.getElementById("bgImage");

    function norm(s){ return (s || "").trim().toLowerCase(); }

    function check(){
      const val = norm(pw.value);
      if(!val){
        msg.textContent = "Enter a word.";
        msg.className = "msg error";
        reveal.style.display = "none";
        return;
      }
      if(ACCEPTED.has(val)){
        msg.textContent = "Accepted.";
        msg.className = "msg ok";
        reveal.style.display = "block";
      } else {
        msg.textContent = "Wrong. The whispers press closer.";
        msg.className = "msg error";
        reveal.style.display = "none";
      }
    }

    enterBtn.addEventListener("click", check);
    pw.addEventListener("keydown", (e)=>{ if(e.key==="Enter") check(); });

    hintBtn.addEventListener("click", ()=>{
      panel.classList.toggle("hintOn");
    });

    bgUpload.addEventListener("change", (e)=>{
      const file = e.target.files && e.target.files[0];
      if(!file) return;
      bgImage.src = URL.createObjectURL(file);
    });
  </script>
</body>
</html>
